# 비트코인 AI 자동매매 시스템 (모듈화 버전)

## 📁 프로젝트 구조

```
gptbitcoin/
├── config/                 # 설정 관리
│   ├── __init__.py
│   └── settings.py        # 환경 변수, API 키, 설정값 관리
├── data/                   # 데이터 수집 및 처리
│   ├── __init__.py
│   ├── market_data.py     # 시장 데이터 수집 (업비트 API)
│   ├── news_data.py       # 뉴스 데이터 수집 및 분석
│   └── screenshot.py      # 차트 스크린샷 캡처
├── analysis/              # 분석 모듈
│   ├── __init__.py
│   ├── models.py          # 분석 모델 정의 (Pydantic)
│   ├── technical_indicators.py  # 기술적 지표 계산
│   └── ai_analysis.py     # AI 분석 및 매매 결정
├── trading/               # 트레이딩 모듈
│   ├── __init__.py
│   ├── account.py         # 계좌 관리, 투자 상태 조회
│   └── execution.py       # 매매 실행
├── utils/                 # 유틸리티
│   ├── __init__.py
│   └── logger.py          # 로깅 유틸리티
├── main.py                # 메인 실행 파일
├── requirements.txt        # 의존성 패키지
└── README.md              # 프로젝트 설명
```

## 🚀 주요 기능

### 1. 설정 관리 (`config/`)
- 환경 변수 및 API 키 관리
- 트레이딩 설정 (최소 거래금액, 수수료율 등)
- 분석 설정 (데이터 개수, 지표 목록 등)

### 2. 데이터 수집 (`data/`)
- **시장 데이터**: 업비트 API를 통한 비트코인 가격 데이터 수집
- **뉴스 데이터**: Google News API를 통한 비트코인 관련 뉴스 수집 및 감정 분석
- **차트 이미지**: Selenium을 사용한 업비트 차트 스크린샷 캡처

### 3. 분석 모듈 (`analysis/`)
- **기술적 지표**: RSI, MACD, 볼린저 밴드, 스토캐스틱 등 10여 가지 지표 계산
- **AI 분석**: OpenAI GPT-4를 사용한 매매 결정
- **Vision API**: 차트 이미지 분석을 통한 시각적 분석

### 4. 트레이딩 모듈 (`trading/`)
- **계좌 관리**: 잔고 조회, 투자 성과 분석
- **매매 실행**: AI 결정에 따른 실제 매매 주문 실행

### 5. 유틸리티 (`utils/`)
- **로깅**: 파일 및 콘솔 로그 기록
- **결과 분석**: 매매 결정 및 실행 결과 로깅

## 🔧 설치 및 설정

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. 환경 변수 설정
`.env` 파일을 생성하고 다음 API 키들을 설정하세요:

```env
# 업비트 API 키
UPBIT_ACCESS_KEY=your_upbit_access_key
UPBIT_SECRET_KEY=your_upbit_secret_key

# OpenAI API 키
OPENAI_API_KEY=your_openai_api_key

# SerpAPI 키 (뉴스 분석용, 선택사항)
SERP_API_KEY=your_serpapi_key
```

### 3. 실행
```bash
python main.py
```

## 📊 주요 특징

### 🔍 다중 데이터 소스 분석
- **기술적 분석**: 10여 가지 기술적 지표
- **시장 심리**: 공포탐욕지수 분석
- **뉴스 감정**: 실시간 뉴스 감정 분석
- **시각적 분석**: 차트 이미지 분석 (Vision API)

### 🤖 AI 기반 매매 결정
- **Structured Output**: JSON 형태의 구조화된 분석 결과
- **신뢰도 평가**: 매매 결정의 신뢰도 점수
- **위험도 평가**: 매매 위험도 등급
- **예상 가격 범위**: AI가 예측하는 가격 범위

### 📈 투자 성과 관리
- **실시간 수익률 계산**: 현재 투자 성과 분석
- **투자 등급**: A+ ~ D 등급의 성과 평가
- **상세 로깅**: 모든 매매 결정과 실행 결과 기록

### 🛡️ 안전 기능
- **최소 거래금액**: 5,000원 이상만 거래
- **수수료 고려**: 매매 시 수수료를 고려한 계산
- **오류 처리**: 각 단계별 예외 처리
- **자동 재시도**: 오류 발생 시 자동 재시도

## ⚙️ 설정 옵션

`config/settings.py`에서 다음 설정들을 조정할 수 있습니다:

```python
# 트레이딩 설정
MIN_TRADE_AMOUNT = 5000      # 최소 거래금액
TRADE_RATIO = 0.95          # 거래 시 사용할 비율 (95%)
FEE_RATE = 0.0005           # 수수료율 (0.05%)

# 분석 설정
DAILY_DATA_COUNT = 30       # 일봉 데이터 개수
MINUTE_DATA_COUNT = 1440    # 분봉 데이터 개수 (24시간)
ANALYSIS_INTERVAL = 300     # 분석 간격 (초)

# 뉴스 분석 설정
NEWS_COUNT = 20            # 수집할 뉴스 개수
NEWS_LANGUAGE = "ko"       # 뉴스 언어
NEWS_REGION = "kr"         # 뉴스 지역
```

## 📝 로그 파일

- **로그 위치**: `logs/` 디렉토리
- **로그 형식**: `gptbitcoin_YYYYMMDD.log`
- **로그 내용**: 매매 결정, 실행 결과, 오류 정보

## 🔄 실행 흐름

1. **데이터 수집**: 시장 데이터, 뉴스, 차트 이미지 수집
2. **기술적 분석**: 다양한 기술적 지표 계산
3. **AI 분석**: GPT-4를 사용한 종합 분석
4. **매매 결정**: buy/sell/hold 결정
5. **매매 실행**: 실제 거래 주문 실행
6. **결과 기록**: 로그 파일에 결과 저장

## ⚠️ 주의사항

- **실제 거래**: 이 시스템은 실제 거래를 수행합니다
- **위험 고지**: 암호화폐 투자는 높은 위험이 따릅니다
- **테스트 권장**: 실제 사용 전 충분한 테스트를 권장합니다
- **API 키 보안**: API 키는 안전하게 관리하세요

## 🆕 모듈화의 장점

### 1. **코드 구조화**
- 기능별로 명확하게 분리된 모듈
- 재사용 가능한 컴포넌트
- 유지보수 용이성

### 2. **확장성**
- 새로운 기능 추가 용이
- 독립적인 모듈 테스트 가능
- 설정 변경 간편

### 3. **가독성**
- 명확한 파일 구조
- 각 모듈의 역할 분명
- 코드 이해도 향상

### 4. **디버깅**
- 모듈별 독립적 디버깅
- 오류 추적 용이
- 로깅 시스템 통합

## 📚 기존 파일 정리

다음 파일들은 이제 모듈화된 구조로 대체되었습니다:
- `mvp.py` → `main.py` + 모듈화된 구조
- `autotrading.py` → 각 기능별 모듈로 분리
- `screenshot_capture.py` → `data/screenshot.py`
- `news_analyzer.py` → `data/news_data.py`

새로운 모듈화된 구조를 사용하시기 바랍니다.
